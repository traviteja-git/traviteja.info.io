---
const navLinks = [
  { href: '/',         label: 'Home'     },
  { href: '/about',   label: 'About'    },
  { href: '/blog',    label: 'Blog'     },
  { href: '/projects',label: 'Projects' },
  { href: '/podcast', label: 'Podcast'  },
];

const currentPath = Astro.url.pathname;
---

<header style="background:var(--bg); border-bottom:1px solid var(--border);" class="sticky top-0 z-50">
  <nav class="max-w-3xl mx-auto px-6 h-14 flex items-center justify-between">
    <!-- Logo -->
    <a href="/" style="color:var(--fg);" class="font-semibold text-base tracking-tight hover:opacity-70 transition-opacity">
      Raviteja Tholupunoori
    </a>

    <!-- Links + Toggle -->
    <div class="flex items-center gap-6">
      <ul class="flex items-center gap-5 list-none m-0 p-0">
        {navLinks.map(({ href, label }) => {
          const isActive = href === '/'
            ? currentPath === '/'
            : currentPath.startsWith(href);
          return (
            <li>
              <a
                href={href}
                style={isActive ? 'color:var(--accent);' : 'color:var(--fg-muted);'}
                class="text-sm font-medium hover:opacity-80 transition-opacity"
              >
                {label}
              </a>
            </li>
          );
        })}
      </ul>

      <!-- Dark / Light toggle -->
      <button
        id="theme-toggle"
        aria-label="Toggle dark/light mode"
        style="color:var(--fg-muted); background:none; border:none;"
        class="cursor-pointer p-1 rounded-md hover:opacity-70 transition-opacity text-lg leading-none"
      >
        <span id="theme-icon">‚òÄÔ∏è</span>
      </button>
    </div>
  </nav>
</header>

<script is:inline>
  (function () {
    const root = document.documentElement;
    const stored = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = stored ?? (prefersDark ? 'dark' : 'light');
    root.setAttribute('data-theme', theme);

    function updateIcon() {
      const icon = document.getElementById('theme-icon');
      if (icon) icon.textContent = root.getAttribute('data-theme') === 'dark' ? '‚òÄÔ∏è' : 'üåô';
    }
    updateIcon();

    document.getElementById('theme-toggle')?.addEventListener('click', () => {
      const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      root.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
      updateIcon();
    });
  })();
</script>
